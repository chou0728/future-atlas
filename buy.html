<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<link rel="stylesheet" type="text/css" href="css/header.css">
<title>設施購票</title>
<style type="text/css">
body{
    background-color: #333;
    color: white;
}
*{
    /*border: 1px solid red;*/
    box-sizing: border-box;
}
button, #submit{
	width: 100%;
	height: 30px;
	background-color: orange;
}#submit{
	background-color: yellow;
}input{
    text-align: right;
}table{
    margin-top: 200px;
}
/*NAV購物車*/
.li_top{
    vertical-align: top;
}
.li_top:nth-child(3) img{
    width: 30px;
    display: inline-block;
    filter: brightness(5);
}#showCartContent{
    width: 180px;
    text-align: center;
    display: none;
    position: absolute;
    top: 50px;
    right: 0;
}.li_top:nth-child(3){
    position: relative;
}
.li_top:nth-child(3):hover #showCartContent{
    display: block;
}
#howmanytickets{
    font-size: 24px;
    color: #5AE6DB;
    display: inline-block;
}#showCartContenttb{
    text-align: left;
    width: 180px;
    /*height: 250px;*/
    position: absolute;
    top: -180px;
    right: 0;
    border: 1px solid white;
}
/*NAV購物車end*/
</style>
</head>
<body>
<div class="header">
    <ul class="ul_top">
        <li class="li_top">
            <a href="SignUp.html" id="registerUser">註冊</a>
        </li>
        <li class="li_top">
            <a href="#" id="singUpBtn">登入</a>
        </li>
        <li class="li_top">
            <!-- 增加 -->
             <a href="input_cart.html">
                <span id="howmanytickets">0</span>
                <img id="cartimgid" src="img/cart/wallet_0.png">
            </a>
                <div id="showCartContent">購物車內容
                    <table id="showCartContenttb"></table>
                </div>
            <!-- 增加end -->
        </li>
    </ul>
</div>
<div class="nav">
    <div class="ul_box">
        <ul class="ul_left">
            <li>
                <a href="Theaterbuyticket.html">劇場購票</a>
            </li>
            <li>
                <a href="facilityBuyTicket.html">設施購票</a>
            </li>
            <li>
                <a href="facilityInfo.html">設施介紹</a>
            </li>
        </ul>
        <h1 style="display: none">FutureAtlas_未來主題樂園</h1>
        <a href="index.html#page1">
            <img src="img/LOGO.png" class="logo">
        </a>
        <ul class="ul_right">
            <li>
                <a href="index.html#page2">園區地圖</a>
            </li>
            <li>
                <a href="activity.html">活動月曆</a>
            </li>
            <li>
                <a href="robot.html">諮詢專區</a>
            </li>
        </ul>
    </div>
    <div class="navOpenBtn"><!-- RWD left btn-->
        <div class="ham"></div>
        <div class="ham"></div>
        <div class="ham"></div>
        <div class="ham"></div>
    </div>
</div>
<div class="headerOpenBtn"><!-- RWD right btn-->
    <img src="img/Usericon1.png" class="memIcon">
    <img src="img/Usericon.png" class="memIcon">
    
</div>

    <!-- header end-->

<table>
    	<tr>
    		<td name="facility_no" class="facility_no">1</td>
    		<td colspan="2" name="facility_name" class="facility_name">設施1</td>
    	</tr>
    	<tr>
    		<td name="full_fare" class="full_fare">NT 150</td>
    		<td><input type="number" name="full_fare_num" class="full_fare_num" value="0" min="1"></td>
    	</tr>
    	<tr>
    		<td name="half_fare" class="half_fare">NT 90</td>
    		<td><input type="number" name="half_fare_num" class="half_fare_num" value="0" min="0"></td>
    	</tr>
		<tr>
			<td colspan="3"><button type="submit" class="saveToCart f_submit">放入購物車</button></td>
		</tr>
		<tr>
    		<td name="facility_no" class="facility_no">2</td>
    		<td colspan="2" name="facility_name" class="facility_name">設施2</td>
    	</tr>
    	<tr>
    		<td name="full_fare" class="full_fare">NT 150</td>
    		<td><input type="number" name="full_fare_num" class="full_fare_num" value="0" min="1"></td>
    	</tr>
    	<tr>
            <td name="half_fare" class="half_fare">NT 90</td>
    		<td><input type="number" name="half_fare_num" class="half_fare_num" value="0" min="0"></td>
    	</tr>
		<tr>
			<td colspan="3"><button type="submit" class="saveToCart f_submit">放入購物車</button></td>
		</tr>
		<tr>
    		<td name="facility_no" class="facility_no">3</td>
    		<td colspan="2" name="facility_name" class="facility_name">設施3</td>
    	</tr>
    	<tr>
            <td name="full_fare" class="full_fare">NT 150</td>
    		<td><input type="number" name="full_fare_num" class="full_fare_num" value="0" min="1"></td>
    	</tr>
    	<tr>
            <td name="half_fare" class="half_fare">NT 90</td>
    		<td><input type="number" name="half_fare_num" class="half_fare_num" value="0" min="0"></td>
    	</tr>
		<tr>
			<td colspan="3"><button type="submit" class="saveToCart f_submit">放入購物車</button></td>
		</tr>
        <tr>
            <td name="facility_no" class="facility_no">4</td>
            <td colspan="2" name="facility_name" class="facility_name">設施4</td>
        </tr>
        <tr>
            <td name="full_fare" class="full_fare">NT 150</td>
            <td><input type="number" name="full_fare_num" class="full_fare_num" value="0" min="1"></td>
        </tr>
        <tr>
            <td name="half_fare" class="half_fare">NT 90</td>
            <td><input type="number" name="half_fare_num" class="half_fare_num" value="0" min="0"></td>
        </tr>
        <tr>
            <td colspan="3"><button type="submit" class="saveToCart f_submit">放入購物車</button></td>
        </tr>
        <tr>
            <td name="facility_no" class="facility_no">5</td>
            <td colspan="2" name="facility_name" class="facility_name">設施5</td>
        </tr>
        <tr>
            <td name="full_fare" class="full_fare">NT 150</td>
            <td><input type="number" name="full_fare_num" class="full_fare_num" value="0" min="1"></td>
        </tr>
        <tr>
            <td name="half_fare" class="half_fare">NT 90</td>
            <td><input type="number" name="half_fare_num" class="half_fare_num" value="0" min="0"></td>
        </tr>
        <tr>
            <td colspan="3"><button type="submit" class="saveToCart f_submit">放入購物車</button></td>
        </tr>
        <tr>
            <td name="facility_no" class="facility_no">6</td>
            <td colspan="2" name="facility_name" class="facility_name">設施6</td>
        </tr>
        <tr>
            <td name="full_fare" class="full_fare">NT 150</td>
            <td><input type="number" name="full_fare_num" class="full_fare_num" value="0" min="1"></td>
        </tr>
        <tr>
            <td name="half_fare" class="half_fare">NT 90</td>
            <td><input type="number" name="half_fare_num" class="half_fare_num" value="0" min="0"></td>
        </tr>
        <tr>
            <td colspan="3"><button type="submit" class="saveToCart f_submit">放入購物車</button></td>
        </tr>
		<tr>
			<td colspan="3"><a href="input_cart.html"><input type="submit" id="submit" value="檢視購物車"></a></td>
		</tr>
</table>
<script src="js/00nav.js"></script>
<script type="text/javascript">
// 加入購物車
$(document).ready(function(){
    var storage = localStorage;
    $(".saveToCart").click(function(){
        var fn = $(this).parent().parent().prev().prev().prev().children(".facility_no").html();
        var ff = $(this).parent().parent().prev().prev().children(".full_fare").html().substr(3);
        var ffn = $(this).parent().parent().prev().prev().children().children(".full_fare_num").val();
        var hf = $(this).parent().parent().prev().children(".half_fare").html().substr(3);
        var hfn = $(this).parent().parent().prev().children().children(".half_fare_num").val();
        var addToCart = ff+"/"+ffn+"/"+hf+"/"+hfn;
        storage.setItem(fn,addToCart);
    });
// 增加
    $(".f_submit").click(function(){
        var storage = localStorage;
        var facility_ticket_list = "";
    
        for( i = 1; i < 7; i++){
            if(storage.getItem(i) != null){
                if(storage.getItem(i).split("/")[1] != 0 || storage.getItem(i).split("/")[3] != 0){
                    facility_ticket_list += i+"/";
                }storage.setItem("facility_ticket_list", facility_ticket_list);
            }
        }
        // 原始購物車外觀
        var newlevel = Math.floor((facility_ticket_list.split("/").length-1)/2);
        var aa = document.getElementById("cartimgid").src.substr(-5,1);
        aa = newlevel;
        document.getElementById("cartimgid").src = "img/cart/wallet_"+aa+".png";
        document.getElementById("howmanytickets").innerHTML = facility_ticket_list.split("/").length-1;
        
        // 更新購物車預覽
            $("#showCartContenttb").empty();
            for(var i = 1; i < 7; i++){
                if(storage.getItem(i) != null){
                    var fn = storage.getItem(i).split("/")[1];
                    var hn = storage.getItem(i).split("/")[3];
                    if(fn != 0 || hn != 0){
                    $("#showCartContenttb").append("<tr><td>設施"+i+"全票"+fn+"張 半票"+hn+"張</td></tr>");                    
                }
            }
        }

    });
    // 增加end

});
</script>
</body>
</html>