<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FA未來主題樂園 | 諮詢專區</title>
    <link rel="icon" href="img/favicon.ico" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" type="text/css" href="css/RESET.css">
    <link rel="stylesheet" type="text/css" href="css/header.css">
    <link rel="stylesheet" href="css/robot_new.css">
    <title>Robot Talk</title>
    <style>
        * {
            box-sizing: border-box;
        }
    </style>

</head>

<body>
    <div class="header">
        <ul class="ul_top">
            <li class="li_top">
                <a href="register.html">註冊</a>
            </li>
            <li class="li_top">
                <a href="#" id="singUpBtn">登入</a>
            </li>
            <li class="li_top">
                <a href="input_cart.php">購物車</a>
            </li>
        </ul>
    </div>
    <div class="nav">
        <div class="ul_box">
            <ul class="ul_left">
                <li>
                    <a href="Theaterbuyticket.php">劇場購票</a>
                </li>
                <li>
                    <a href="facilityBuyTicket.php">設施購票</a>
                </li>
                <li>
                    <a href="facilityInfo.php">設施介紹</a>
                </li>
            </ul>
            <h1 style="display: none">FutureAtlas_未來主題樂園</h1>
            <a href="====index.php" class="logo_a">
                <img src="img/LOGO.png" class="logo">
            </a>
            <ul class="ul_right">
                <li>
                    <a href="====index.php#page2">園區地圖</a>
                </li>
                <li>
                    <a href="activity.php">活動月曆</a>
                </li>
                <li>
                    <a href="robot.html">諮詢專區</a>
                </li>
            </ul>
        </div>
        <div class="navOpenBtn">
            <!-- RWD left btn-->
            <div class="ham"></div>
            <div class="ham"></div>
            <div class="ham"></div>
            <div class="ham"></div>
        </div>
    </div>
    <div class="headerOpenBtn">
        <!-- RWD right btn-->
        <img src="img/memberBtnM.png" class="memIcon">
        <img src="img/ticketicon.png" class="ticketIcon">
        <div class="blueScreen"></div>
    </div>
    <div class="wrapper">
        <!-- <img class="frame" src="img/robot_page/frame.png" alt=""> -->
        <img class="robot" src="img/robot_page/robot2.png" alt="">

        <div class="conversation">

            <p id="robot_greet"></p>
            <p id="user_message"></p>
            <p id="robot_answer"></p>


            <!-- <img class="chat_area" src="img/robot_page/chat_block.png" alt=""> -->
            <!-- <img class="brackets" src="img/robot_page/brackets.png" alt=""> -->
            <div class="input_area">
                <input type="text" id="input_box" placeholder="請在這輸入您的疑問">
                <!-- <button class="submit">送出</button> -->
            </div>

        </div>

    </div>

    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="js/00nav.js"></script>
    <script>
        var message = "您好，我是Future Atlas的守護者，有什麼我能協助您的?";
        var input_box = document.getElementById("input_box");
        initIdentityResults(0);

        function initIdentityResults(i) {
            $("#robot_greet").addClass("cursor").text(message.substring(0, i));
            if (i < message.length) {
                setTimeout(function () {
                    initIdentityResults(i + 1);
                }, 100);
            }

        }


        $("#input_box").on('keydown', function (e) {
            if (e.which == 13 || e.keyCode == 13) {
                $("#robot_greet").removeClass("cursor");
                var user_text = $("#input_box").val();
                getAnswer();
                // initIdentityResults_user(0);
                clearInputbox();


                function getAnswer() {

                    var xhr = new XMLHttpRequest();
                    xhr.onload = function () {

                        if (xhr.status == 200) {

                            var answer = xhr.responseText;
                            initIdentityResults_user(0);

                            function initIdentityResults_user(i) {
                                $("#user_message").addClass("cursor").text(user_text.substring(0, i));
                                if (i < user_text.length) {
                                    setTimeout(function () {
                                        initIdentityResults_user(i + 1);
                                    }, 100);
                                } else {
                                    $("#user_message").removeClass("cursor");
                                    var robot_answer = answer;
                                    initIdentityResults_robot_answer(0);

                                    function initIdentityResults_robot_answer(i) {
                                        $("#robot_answer").addClass("cursor").text(robot_answer.substring(0,
                                            i));
                                        if (i < robot_answer.length) {
                                            setTimeout(function () {
                                                initIdentityResults_robot_answer(i + 1);
                                            }, 100);
                                        }

                                    }
                                }

                            }
                        } else {
                            alert(xhr.status);
                        }



                    } // xhr.onload

                    //設定好所要連結的程式
                    var url = "question_and_answer.php";
                    xhr.open("post", url, true);

                    //送出資料
                    var data_info = "user_text=" + user_text;
                    xhr.setRequestHeader("content-type","application/x-www-form-urlencoded");
                    xhr.send( data_info );






                } // function getAnswer()


                function clearInputbox() {
                    $("#input_box").val("");
                }



            } //if (e.which == 13 || e.keyCode == 13){}

        }); //$("#input_box").on('keydown', function (e) {})
    </script>


</body>


</html>